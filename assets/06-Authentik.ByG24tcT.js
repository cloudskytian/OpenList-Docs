import{_ as h}from"./ValaxyMain.CdqkJyL8.js";import"./chunks/nprogress.B1y48mDD.js";import{d as m,u as g,a as k}from"./chunks/vue-router.B9LoLhP8.js";import{$ as f,a1 as n,V as y,a0 as S,a2 as i,a4 as l,a5 as e,X as b}from"./framework.Bz32nx7L.js";import"./app.pW5IfVex.js";import"./chunks/dayjs.BX5x0S-s.js";import"./chunks/vue-i18n.D51u75hK.js";import"./chunks/pinia.Bgqu1Nyu.js";/* empty css                    */const v=m("/guide/advanced/sso/06-Authentik",async a=>JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"pages/guide/advanced/sso/06-Authentik.md","lastUpdated":1770781566000}'),{lazy:(a,o)=>a.name===o.name}),$={__name:"06-Authentik",setup(a,{expose:o}){const{data:u}=v(),p=k(),c=g(),s=Object.assign(c.meta.frontmatter||{},u.value?.frontmatter||{});return p.currentRoute.value.data=u.value,b("valaxy:frontmatter",s),globalThis.$frontmatter=s,o({frontmatter:{}}),(t,r)=>{const d=h;return S(),f(d,{frontmatter:y(s)},{"main-content-md":n(()=>r[0]||(r[0]=[l("h3",{id:"_3-6-authentik",tabindex:"-1"},[e("3.6. Authentik "),l("a",{class:"header-anchor",href:"#_3-6-authentik","aria-label":'Permalink to "3.6. Authentik"'},"​")],-1),l("h4",{lang:"en",id:"_3-6-1-authentik-setup",tabindex:"-1"},[e("3.6.1. Authentik Setup "),l("a",{class:"header-anchor",href:"#_3-6-1-authentik-setup","aria-label":'Permalink to "3.6.1. Authentik Setup { lang="en" }"'},"​")],-1),l("h4",{lang:"zh-CN",id:"_3-6-1-authentik-设置",tabindex:"-1"},[e("3.6.1. Authentik 设置 "),l("a",{class:"header-anchor",href:"#_3-6-1-authentik-设置","aria-label":'Permalink to "3.6.1. Authentik 设置 { lang="zh-CN" }"'},"​")],-1),l("div",{lang:"en"},[l("p",null,[l("strong",null,"Create a Provider for OpenList")]),l("ol",null,[l("li",null,"Menu -> Applications -> Providers -> Create"),l("li",null,[e("Select "),l("code",null,"OAuth2/OpenID Provider"),e(" and click next")]),l("li",null,[e("Enter an application name, this guide assumes you will call the provider "),l("code",null,"OpenList")]),l("li",null,[e("Select your authorization flow. The built-in "),l("code",null,"default-provider-authorization-implicit-consent"),e(" is acceptable")]),l("li",null,[e("Make note of the "),l("code",null,"Client ID"),e(" and "),l("code",null,"Client Secret"),e(" fields as provided by Authentik - save these values for later")]),l("li",null,"For Redirect UDIs/Origins, enter the following, replacing [your.openlist.domain] with the FQDN for your OpenList installation:")]),l("div",{class:"language-bash"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"bash"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"https://your.openlist.domain/api/auth/sso_callback\\?method"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"=sso_get_token")]),e(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"https://your.openlist.domain/api/auth/sso_callback\\?method"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"=get_sso_id")])])]),l("button",{class:"collapse"})]),l("pre",null,[l("code",null,`Please note the \\ character before ? as an escape character for the regex used for this URI is mandatory.
`)]),l("ol",{start:"7"},[l("li",null,[e("Make note of the signing key selected as you will need it later. This guide assumes you will use the default "),l("code",null,"authentik Self-signed Certificate")]),l("li",null,"Save the new provider")]),l("p",null,[l("strong",null,"Create an Application for OpenList")]),l("ol",null,[l("li",null,"Menu -> Applications -> Application -> Create"),l("li",null,[e("Enter an application name, recommended "),l("code",null,"OpenList")]),l("li",null,[e("An application slug of "),l("code",null,"openlist"),e(" will be automatically selected for you. This guide assumes you will keep this value")]),l("li",null,[e("Select the provider by name you selected in Provider Setup step 3 - "),l("code",null,"OpenList")]),l("li",null,"Save the new application")]),l("p",null,[l("strong",null,"Retrieve the JWT certificate")]),l("ol",null,[l("li",null,"Menu -> System -> Certificates"),l("li",null,[e("Select the "),l("code",null,">"),e(" next to the "),l("code",null,"authentik Self-signed Certificate"),e(". If you chose another certificate for the application, select that certificate instead")]),l("li",null,"Click Download Certificate to get a copy of the public JWT key")])],-1),l("div",{lang:"zh-CN"},[l("p",null,[l("strong",null,"为 OpenList 创建提供程序")]),l("ol",null,[l("li",null,"菜单 -> 应用程序 -> 提供程序 -> 创建"),l("li",null,[e("选择 "),l("code",null,"OAuth2/OpenID 提供程序"),e(" 并点击下一步")]),l("li",null,[e("输入应用程序名称，本指南假设你将提供程序命名为 "),l("code",null,"OpenList")]),l("li",null,[e("选择授权流。内置的 "),l("code",null,"default-provider-authorization-implicit-consent"),e(" 是可接受的")]),l("li",null,[e("记下由 Authentik 提供的 "),l("code",null,"Client ID"),e(" 和 "),l("code",null,"Client Secret"),e(" 字段—保存这些值以供后用")]),l("li",null,"对于重定向的 UDI/来源，输入以下内容，将 [your.openlist.domain] 替换为你的 OpenList 安装的 FQDN：")]),l("div",{class:"language-bash"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"bash"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"https://your.openlist.domain/api/auth/sso_callback\\?method"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"=sso_get_token")]),e(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"https://your.openlist.domain/api/auth/sso_callback\\?method"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"=get_sso_id")])])]),l("button",{class:"collapse"})]),l("div",{class:"language-"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"}),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",null,"请注意，? 前的 \\ 字符作为正则表达式中 URI 的转义字符是必需的。")])])]),l("button",{class:"collapse"})]),l("ol",{start:"7"},[l("li",null,[e("记下所选的签名密钥，稍后会用到。假设你将使用默认的 "),l("code",null,"authentik 自签名证书")]),l("li",null,"保存新的提供程序")]),l("p",null,[l("strong",null,"为 OpenList 创建应用程序")]),l("ol",null,[l("li",null,"菜单 -> 应用程序 -> 应用程序 -> 创建"),l("li",null,[e("输入应用程序名称，建议使用 "),l("code",null,"OpenList")]),l("li",null,[e("应用程序 slug 将自动选择为 "),l("code",null,"openlist"),e("。本指南假设你会保留此值")]),l("li",null,[e("选择在提供程序设置步骤 3 中选择的提供程序名称 — "),l("code",null,"OpenList")]),l("li",null,"保存新的应用程序")]),l("p",null,[l("strong",null,"获取 JWT 证书")]),l("ol",null,[l("li",null,"菜单 -> 系统 -> 证书"),l("li",null,[e("选择 "),l("code",null,">"),e(" 旁边的 "),l("code",null,"authentik 自签名证书"),e("。如果你为应用选择了其他证书，选择该证书")]),l("li",null,"点击“下载证书”以获取公共 JWT 密钥的副本")])],-1),l("h4",{lang:"en",id:"_3-6-2-openlist-setup",tabindex:"-1"},[e("3.6.2. OpenList Setup "),l("a",{class:"header-anchor",href:"#_3-6-2-openlist-setup","aria-label":'Permalink to "3.6.2. OpenList Setup { lang="en" }"'},"​")],-1),l("h4",{lang:"zh-CN",id:"_3-6-2-openlist-设置",tabindex:"-1"},[e("3.6.2. OpenList 设置 "),l("a",{class:"header-anchor",href:"#_3-6-2-openlist-设置","aria-label":'Permalink to "3.6.2. OpenList 设置 { lang="zh-CN" }"'},"​")],-1),l("div",{lang:"en"},[l("ul",null,[l("li",null,[l("strong",null,"Sso login enabled:"),e(),l("code",null,"yes")]),l("li",null,[l("strong",null,"Sso login platform:"),e(),l("code",null,"OIDC")]),l("li",null,[l("strong",null,"Sso client id:"),e(" [Client ID from Authentik]")]),l("li",null,[l("strong",null,"Sso client secret:"),e(" [Client Secret from Authentik]")]),l("li",null,[l("strong",null,"Sso oidc username key:"),e(),l("code",null,"preferred_username")]),l("li",null,[l("strong",null,"Sso organization name:"),e(),l("code",null,"user")]),l("li",null,[l("strong",null,"Sso application name:"),e(),l("code",null,"user")]),l("li",null,[l("strong",null,"Sso endpoint name:"),e(),l("code",null,"https://your.authentik.domain/application/o/openlist/"),l("ul",null,[l("li",null,[l("strong",null,"Note:"),e(" Replace [your.authentik.domain] with the FQDN for your Authentik installation. Mind the trailing "),l("code",null,"/"),e(" at the end of the path. If you chose a different application slug in Authentik Application setup 3, substitute that here")])])]),l("li",null,[l("strong",null,"Sso jwt public key:"),e(" Open the certificate file downloaded in step 3.3 of the Authentik Application setup and paste the contents here. It will start with "),l("code",null,"-----BEGIN CERTIFICATE-----")]),l("li",null,[l("strong",null,"Sso compatability mode:"),e(),l("code",null,"no")])])],-1),l("div",{lang:"zh-CN"},[l("ul",null,[l("li",null,[l("p",null,[l("strong",null,"启用 SSO 登录："),e(),l("code",null,"是")])]),l("li",null,[l("p",null,[l("strong",null,"SSO 登录平台："),e(),l("code",null,"OIDC")])]),l("li",null,[l("p",null,[l("strong",null,"SSO 客户端 ID："),e(" [来自 Authentik 的 Client ID]")])]),l("li",null,[l("p",null,[l("strong",null,"SSO 客户端密钥："),e(" [来自 Authentik 的 Client Secret]")])]),l("li",null,[l("p",null,[l("strong",null,"SSO OIDC 用户名键："),e(),l("code",null,"preferred_username")])]),l("li",null,[l("p",null,[l("strong",null,"SSO 组织名称："),e(),l("code",null,"user")])]),l("li",null,[l("p",null,[l("strong",null,"SSO 应用程序名称："),e(),l("code",null,"user")])]),l("li",null,[l("p",null,[l("strong",null,"SSO 端点名称："),e(),l("code",null,"https://your.authentik.domain/application/o/openlist/")]),l("ul",null,[l("li",null,[l("strong",null,"注意："),e(" 将 [your.authentik.domain] 替换为你的 Authentik 安装的 FQDN。注意路径末尾的斜杠 "),l("code",null,"/"),e("。如果你在 Authentik 应用程序设置第 3 步选择了不同的应用程序 slug，请在此处替换")])])]),l("li",null,[l("p",null,[l("strong",null,"SSO JWT 公钥："),e(" 打开在 Authentik 应用程序设置第 3.3 步中下载的证书文件，并将内容粘贴在此处。它以 "),l("code",null,"-----BEGIN CERTIFICATE-----"),e(" 开头")])]),l("li",null,[l("p",null,[l("strong",null,"SSO 兼容模式："),e(),l("code",null,"否")])])])],-1)])),"main-header":n(()=>[i(t.$slots,"main-header")]),"main-header-after":n(()=>[i(t.$slots,"main-header-after")]),"main-nav":n(()=>[i(t.$slots,"main-nav")]),"main-content-before":n(()=>[i(t.$slots,"main-content-before")]),"main-content":n(()=>[i(t.$slots,"main-content")]),"main-content-after":n(()=>[i(t.$slots,"main-content-after")]),"main-nav-before":n(()=>[i(t.$slots,"main-nav-before")]),"main-nav-after":n(()=>[i(t.$slots,"main-nav-after")]),comment:n(()=>[i(t.$slots,"comment")]),footer:n(()=>[i(t.$slots,"footer")]),aside:n(()=>[i(t.$slots,"aside")]),"aside-custom":n(()=>[i(t.$slots,"aside-custom")]),default:n(()=>[i(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{$ as default,v as usePageData};
