import{_ as m}from"./ValaxyMain.CdqkJyL8.js";import"./chunks/nprogress.B1y48mDD.js";import{_ as p,a as g,b as f}from"./keycloak-03.M36mrG_t.js";import{d as b,u as k,a as y}from"./chunks/vue-router.B9LoLhP8.js";import{$ as C,a1 as n,V as _,a0 as S,a2 as a,a4 as l,a5 as e,X as O}from"./framework.Bz32nx7L.js";import"./app.pW5IfVex.js";import"./chunks/dayjs.BX5x0S-s.js";import"./chunks/vue-i18n.D51u75hK.js";import"./chunks/pinia.Bgqu1Nyu.js";/* empty css                    */const v=b("/guide/advanced/sso/07-keycloak",async o=>JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"pages/guide/advanced/sso/07-keycloak.md","lastUpdated":1770781566000}'),{lazy:(o,i)=>o.name===i.name}),$={__name:"07-keycloak",setup(o,{expose:i}){const{data:u}=v(),d=y(),c=k(),r=Object.assign(c.meta.frontmatter||{},u.value?.frontmatter||{});return d.currentRoute.value.data=u.value,O("valaxy:frontmatter",r),globalThis.$frontmatter=r,i({frontmatter:{}}),(t,s)=>{const h=m;return S(),C(h,{frontmatter:_(r)},{"main-content-md":n(()=>s[0]||(s[0]=[l("h3",{id:"_3-7-keycloak",tabindex:"-1"},[e("3.7. Keycloak "),l("a",{class:"header-anchor",href:"#_3-7-keycloak","aria-label":'Permalink to "3.7. Keycloak"'},"​")],-1),l("div",{lang:"zh-CN"},[l("p",null,"Keycloak 通过 OIDC（OpenID Connect）协议实现与 OpenList 的单点登录对接，可以作为 OpenList 的身份提供者，下面是配置步骤。")],-1),l("div",{lang:"en"},[l("p",null,"Keycloak is integrated via the OIDC (OpenID Connect) protocol and can serve as an identity provider for OpenList. The steps below explain how to configure Keycloak for OpenList SSO.")],-1),l("h4",{lang:"zh-CN",id:"_3-7-1-keycloak-设置",tabindex:"-1"},[e("3.7.1. Keycloak 设置 "),l("a",{class:"header-anchor",href:"#_3-7-1-keycloak-设置","aria-label":'Permalink to "3.7.1. Keycloak 设置 { lang="zh-CN" }"'},"​")],-1),l("h4",{lang:"en",id:"_3-7-1-keycloak-setup",tabindex:"-1"},[e("3.7.1. Keycloak Setup "),l("a",{class:"header-anchor",href:"#_3-7-1-keycloak-setup","aria-label":'Permalink to "3.7.1. Keycloak Setup { lang="en" }"'},"​")],-1),l("h5",{lang:"en",id:"_3-7-1-1-create-realm",tabindex:"-1"},[e("3.7.1.1. Create Realm "),l("a",{class:"header-anchor",href:"#_3-7-1-1-create-realm","aria-label":'Permalink to "3.7.1.1. Create Realm { lang="en" }"'},"​")],-1),l("h5",{lang:"zh-CN",id:"_3-7-1-1-新建-realm",tabindex:"-1"},[e("3.7.1.1. 新建 Realm "),l("a",{class:"header-anchor",href:"#_3-7-1-1-新建-realm","aria-label":'Permalink to "3.7.1.1. 新建 Realm { lang="zh-CN" }"'},"​")],-1),l("div",{lang:"zh-CN"},[l("ul",null,[l("li",null,"登录到 Keycloak 管理控制台。"),l("li",null,[e("在左侧导航栏点击 "),l("code",null,"Manage realms"),e("，选择"),l("code",null,"Create Realm"),e("新建领域，或选用现有领域。")])])],-1),l("div",{lang:"en"},[l("ul",null,[l("li",null,"Log in to the Keycloak admin console."),l("li",null,[e("Click "),l("code",null,"Manage realms"),e(" in the left navigation bar, select "),l("code",null,"Create Realm"),e(" to create a new realm or use an existing one.")])])],-1),l("h5",{lang:"en",id:"_3-7-1-2-create-client",tabindex:"-1"},[e("3.7.1.2. Create Client "),l("a",{class:"header-anchor",href:"#_3-7-1-2-create-client","aria-label":'Permalink to "3.7.1.2. Create Client { lang="en" }"'},"​")],-1),l("h5",{lang:"zh-CN",id:"_3-7-1-2-新建-client",tabindex:"-1"},[e("3.7.1.2. 新建 Client "),l("a",{class:"header-anchor",href:"#_3-7-1-2-新建-client","aria-label":'Permalink to "3.7.1.2. 新建 Client { lang="zh-CN" }"'},"​")],-1),l("div",{lang:"zh-CN"},[l("p",null,[e("选择领域后，在左侧菜单中找到 "),l("code",null,"Clients"),e("并且进入该页面，点击"),l("code",null,"Create Client"),e("。")])],-1),l("div",{lang:"en"},[l("p",null,[e("After selecting the realm, click "),l("code",null,"Clients"),e(" → "),l("code",null,"Create Client"),e(".")])],-1),l("ul",null,[l("li",null,[l("p",null,[l("strong",null,"General settings"),l("img",{src:p,alt:""})]),l("div",{lang:"en"},[l("details",{class:"details custom-block"},[l("summary",null,"see the details"),l("table",null,[l("thead",null,[l("tr",null,[l("th",null,"Name"),l("th",null,"Value")])]),l("tbody",null,[l("tr",null,[l("td",null,"Client type"),l("td",null,"OpenID Connect")]),l("tr",null,[l("td",null,"Client ID"),l("td",null,"OpenList (or any name you prefer)")]),l("tr",null,[l("td",null,"Name"),l("td",null,"OpenList (or any name you prefer)")]),l("tr",null,[l("td",null,"Description"),l("td",null,"optional")]),l("tr",null,[l("td",null,"Always display in UI"),l("td",null,"select as needed")])])])])]),l("div",{lang:"zh-CN"},[l("details",{class:"details custom-block"},[l("summary",null,"查看详情"),l("table",null,[l("thead",null,[l("tr",null,[l("th",null,"配置名"),l("th",null,"配置值")])]),l("tbody",null,[l("tr",null,[l("td",null,"客户端类型"),l("td",null,"OpenID Connect")]),l("tr",null,[l("td",null,"客户端ID"),l("td",null,"OpenList（或你喜欢的任何名称）")]),l("tr",null,[l("td",null,"名称"),l("td",null,"OpenList（或你喜欢的任何名称）")]),l("tr",null,[l("td",null,"描述"),l("td",null,"可选")]),l("tr",null,[l("td",null,"始终在 UI 中显示"),l("td",null,"根据需要选择")])])])])])]),l("li",null,[l("p",null,[l("strong",null,"Capability config"),l("img",{src:g,alt:""})]),l("div",{lang:"zh-CN"},[l("details",{class:"details custom-block"},[l("summary",null,"查看详情"),l("table",null,[l("thead",null,[l("tr",null,[l("th",null,"配置名"),l("th",null,"配置值")])]),l("tbody",null,[l("tr",null,[l("td",null,"Client authentication"),l("td",null,"On")]),l("tr",null,[l("td",null,"Authorization"),l("td",null,"Off")]),l("tr",null,[l("td",null,"Authentication flow"),l("td",null,[l("code",null,"Standard Flow"),e("，"),l("code",null,"Service account roles")])]),l("tr",null,[l("td",null,"PKCE Method"),l("td",null,"留空")]),l("tr",null,[l("td",null,"Require DPoP bound tokens"),l("td",null,"Off")])])])])]),l("div",{lang:"en"},[l("details",{class:"details custom-block"},[l("summary",null,"see the details"),l("table",null,[l("thead",null,[l("tr",null,[l("th",null,"Name"),l("th",null,"Value")])]),l("tbody",null,[l("tr",null,[l("td",null,"Client authentication"),l("td",null,"On")]),l("tr",null,[l("td",null,"Authorization"),l("td",null,"Off")]),l("tr",null,[l("td",null,"Authentication flow"),l("td",null,[l("code",null,"Standard Flow"),e("，"),l("code",null,"Service account roles")])]),l("tr",null,[l("td",null,"PKCE Method"),l("td",null,"Leave blank")]),l("tr",null,[l("td",null,"Require DPoP bound tokens"),l("td",null,"Off")])])])])])]),l("li",null,[l("p",null,[l("strong",null,"Login settings"),l("img",{src:f,alt:""})]),l("div",{lang:"zh-CN"},[l("details",{class:"details custom-block"},[l("summary",null,"查看详情"),l("table",null,[l("thead",null,[l("tr",null,[l("th",null,"配置名"),l("th",null,"配置值")])]),l("tbody",null,[l("tr",null,[l("td",null,"Root URL"),l("td",null,"留空")]),l("tr",null,[l("td",null,"Home URL"),l("td",null,[e("填入你OpenList的访问地址，如："),l("a",{href:"https://your.openlist.domain",target:"_blank",rel:"noreferrer"},"https://your.openlist.domain")])]),l("tr",null,[l("td",null,"Valid redirect URIs"),l("td",null,[l("code",null,"https://your.openlist.domain/api/auth/sso_callback?method=get_sso_id"),l("br"),l("code",null,"https://your.openlist.domain/api/auth/sso_callback?method=sso_get_token"),l("br"),l("code",null,"https://your.openlist.domain/api/auth/sso_get_token"),l("br"),l("code",null,"https://your.openlist.domain/api/auth/get_sso_id")])]),l("tr",null,[l("td",null,"Valid post logout redirect URIs"),l("td",null,"留空")]),l("tr",null,[l("td",null,"Web origins"),l("td",null,"留空")])])])])]),l("div",{lang:"en"},[l("details",{class:"details custom-block"},[l("summary",null,"see the details"),l("table",null,[l("thead",null,[l("tr",null,[l("th",null,"Name"),l("th",null,"Value")])]),l("tbody",null,[l("tr",null,[l("td",null,"Root URL"),l("td",null,"Leave blank")]),l("tr",null,[l("td",null,"Home URL"),l("td",null,[e("Enter your OpenList access address, e.g.: "),l("a",{href:"https://your.openlist.domain",target:"_blank",rel:"noreferrer"},"https://your.openlist.domain")])]),l("tr",null,[l("td",null,"Valid redirect URIs"),l("td",null,[l("code",null,"https://your.openlist.domain/api/auth/sso_callback?method=get_sso_id"),l("br"),l("code",null,"https://your.openlist.domain/api/auth/sso_callback?method=sso_get_token"),l("br"),l("code",null,"https://your.openlist.domain/api/auth/sso_get_token"),l("br"),l("code",null,"https://your.openlist.domain/api/auth/get_sso_id")])]),l("tr",null,[l("td",null,"Valid post logout redirect URIs"),l("td",null,"Leave blank")]),l("tr",null,[l("td",null,"Web origins"),l("td",null,"Leave blank")])])])])])])],-1),l("h5",{lang:"zh-CN",id:"_3-7-1-3-获取jwt公钥",tabindex:"-1"},[e("3.7.1.3. 获取JWT公钥 "),l("a",{class:"header-anchor",href:"#_3-7-1-3-获取jwt公钥","aria-label":'Permalink to "3.7.1.3. 获取JWT公钥 { lang="zh-CN" }"'},"​")],-1),l("h5",{lang:"en",id:"_3-7-1-3-retrieve-jwt-public-key",tabindex:"-1"},[e("3.7.1.3. Retrieve JWT public key "),l("a",{class:"header-anchor",href:"#_3-7-1-3-retrieve-jwt-public-key","aria-label":'Permalink to "3.7.1.3. Retrieve JWT public key { lang="en" }"'},"​")],-1),l("div",{lang:"zh-CN"},[l("ul",null,[l("li",null,[e("在左侧找到 "),l("code",null,"Clients"),e("，选择刚创建的 Client 进入设置页面。")]),l("li",null,[e("在 Client 设置页面，切换到 "),l("code",null,"Keys"),e(" 选项卡。")]),l("li",null,[e("在 "),l("code",null,"Public Key"),e(" 字段中复制公钥内容，稍后在 OpenList 配置中使用。")]),l("li",null,[e("如果没有看到公钥，可以点击 "),l("code",null,"Generate RSA Keys"),e(" 生成")])])],-1),l("div",{lang:"en"},[l("ul",null,[l("li",null,[e("In the left menu, find "),l("code",null,"Clients"),e(", select the newly created Client to enter the settings page.")]),l("li",null,[e("In the Client settings page, switch to the "),l("code",null,"Keys"),e(" tab.")]),l("li",null,[e("Copy the content in the "),l("code",null,"Public Key"),e(" field for later use in OpenList configuration.")]),l("li",null,[e("If the public key is not visible, click "),l("code",null,"Generate RSA Keys"),e(" to generate it.")])])],-1),l("h5",{lang:"zh-CN",id:"_3-7-1-4-获取client-secret",tabindex:"-1"},[e("3.7.1.4. 获取Client Secret "),l("a",{class:"header-anchor",href:"#_3-7-1-4-获取client-secret","aria-label":'Permalink to "3.7.1.4. 获取Client Secret { lang="zh-CN" }"'},"​")],-1),l("h5",{lang:"en",id:"_3-7-1-4-retrieve-client-secret",tabindex:"-1"},[e("3.7.1.4. Retrieve Client Secret "),l("a",{class:"header-anchor",href:"#_3-7-1-4-retrieve-client-secret","aria-label":'Permalink to "3.7.1.4. Retrieve Client Secret { lang="en" }"'},"​")],-1),l("div",{lang:"zh-CN"},[l("ul",null,[l("li",null,[e("在 Client 设置页面，切换到 "),l("code",null,"Credentials"),e(" 选项卡。")]),l("li",null,[e("在 "),l("code",null,"Client Secret"),e(" 字段中复制客户端密钥内容，稍后在 OpenList 配置中使用。")])])],-1),l("div",{lang:"en"},[l("ul",null,[l("li",null,[e("In the Client settings page, switch to the "),l("code",null,"Credentials"),e(" tab.")]),l("li",null,[e("Copy the content in the "),l("code",null,"Client Secret"),e(" field for later use in OpenList configuration.")])])],-1),l("h4",{lang:"zh-CN",id:"_3-7-2-openlist-设置",tabindex:"-1"},[e("3.7.2. OpenList 设置 "),l("a",{class:"header-anchor",href:"#_3-7-2-openlist-设置","aria-label":'Permalink to "3.7.2. OpenList 设置 { lang="zh-CN" }"'},"​")],-1),l("h4",{lang:"en",id:"_3-7-2-openlist-setup",tabindex:"-1"},[e("3.7.2. OpenList Setup "),l("a",{class:"header-anchor",href:"#_3-7-2-openlist-setup","aria-label":'Permalink to "3.7.2. OpenList Setup { lang="en" }"'},"​")],-1),l("div",{lang:"zh-CN"},[l("p",null,"在 OpenList 的单点登录配置填写如下参数："),l("ul",null,[l("li",null,[l("strong",null,"启用 SSO 登录"),e("："),l("code",null,"是")]),l("li",null,[l("strong",null,"SSO 登录平台"),e("："),l("code",null,"OIDC")]),l("li",null,[l("strong",null,"SSO 客户端ID"),e("：Keycloak 客户端 ID（见上文"),l("a",{href:"#_3-7-1-2-%E6%96%B0%E5%BB%BA-client"},"新建 Client"),e("）")]),l("li",null,[l("strong",null,"SSO 客户端密钥"),e("：Keycloak 客户端 Secret（见上文"),l("a",{href:"#_3-7-1-4-%E8%8E%B7%E5%8F%96client-secret"},"获取Client Secret"),e("）")]),l("li",null,[l("strong",null,"SSO OIDC 用户名键"),e("："),l("code",null,"preferred_username"),e(" 或按你的 Mapper 设置")]),l("li",null,[l("strong",null,"SSO 组织名称"),e("："),l("code",null,"master"),e(" （与上文"),l("a",{href:"#_3-7-1-1-%E6%96%B0%E5%BB%BA-realm"},"新建 Realm"),e("名称对应）")]),l("li",null,[l("strong",null,"SSO 应用名"),e("："),l("code",null,"OpenList"),e(" （见上文"),l("a",{href:"#_3-7-1-2-%E6%96%B0%E5%BB%BA-client"},"新建 Client"),e("）")]),l("li",null,[l("strong",null,"SSO 端点名称"),e("："),l("code",null,"https://your.keycloak.domain/realms/{realm-name}"),e(" （realm-name与组织名一致）")]),l("li",null,[l("strong",null,"SSO JWT 公钥"),e("：见上文"),l("a",{href:"#_3-7-1-3-%E8%8E%B7%E5%8F%96JWT%E5%85%AC%E9%92%A5"},"获取JWT公钥")]),l("li",null,[l("strong",null,"自动注册为 OpenList 帐号"),e("：根据需要开启")]),l("li",null,[l("strong",null,"SSO 兼容模式"),e("："),l("code",null,"否"),e(" （如果需要兼容可开启）")])]),l("p",null,"如有特殊需求，根据实际 Keycloak 部署调整 claims 和端点。"),l("p",null,[e("详细操作请参考 "),l("a",{href:"https://www.keycloak.org/documentation",target:"_blank",rel:"noreferrer"},"Keycloak 官方 OIDC 文档"),e("。")])],-1),l("div",{lang:"en"},[l("p",null,"Fill in the following parameters in OpenList’s SSO configuration:"),l("ul",null,[l("li",null,[l("strong",null,"SSO login enabled:"),e(),l("code",null,"yes")]),l("li",null,[l("strong",null,"SSO login platform:"),e(),l("code",null,"OIDC")]),l("li",null,[l("strong",null,"SSO client id:"),e(" Keycloak Client ID (from "),l("a",{href:"#_3-7-1-2-create-client"},"Create Client"),e(" above)")]),l("li",null,[l("strong",null,"SSO client secret:"),e(" Keycloak Client Secret (from "),l("a",{href:"#_3-7-1-4-retrieve-client-secret"},"Retrieve Client Secret"),e(" above)")]),l("li",null,[l("strong",null,"SSO oidc username key:"),e(),l("code",null,"preferred_username"),e(" or as per your Mapper settings")]),l("li",null,[l("strong",null,"SSO organization name:"),e(),l("code",null,"master"),e(" (from "),l("a",{href:"#_3-7-1-1-create-realm"},"Create Realm"),e(" above)")]),l("li",null,[l("strong",null,"SSO application name:"),e(),l("code",null,"OpenList"),e(" (from "),l("a",{href:"#_3-7-1-2-create-client"},"Create Client"),e(" above)")]),l("li",null,[l("strong",null,"SSO endpoint name:"),e(),l("code",null,"https://your.keycloak.domain/realms/{realm-name}"),e(" (where realm-name matches the organization name)")]),l("li",null,[l("strong",null,"SSO jwt public key:"),e(" from "),l("a",{href:"#_3-7-1-3-retrieve-jwt-public-key"},"Retrieve JWT public key"),e(" above")]),l("li",null,[l("strong",null,"SSO auto register as OpenList account:"),e(" Enable as needed")]),l("li",null,[l("strong",null,"SSO compatibility mode:"),e(),l("code",null,"no"),e(" (enable if compatibility is required)")])]),l("p",null,[e("Adjust claims and endpoints based on your specific Keycloak deployment if needed. For detailed operations, refer to the "),l("a",{href:"https://www.keycloak.org/documentation",target:"_blank",rel:"noreferrer"},"Keycloak official OIDC documentation"),e(".")])],-1)])),"main-header":n(()=>[a(t.$slots,"main-header")]),"main-header-after":n(()=>[a(t.$slots,"main-header-after")]),"main-nav":n(()=>[a(t.$slots,"main-nav")]),"main-content-before":n(()=>[a(t.$slots,"main-content-before")]),"main-content":n(()=>[a(t.$slots,"main-content")]),"main-content-after":n(()=>[a(t.$slots,"main-content-after")]),"main-nav-before":n(()=>[a(t.$slots,"main-nav-before")]),"main-nav-after":n(()=>[a(t.$slots,"main-nav-after")]),comment:n(()=>[a(t.$slots,"comment")]),footer:n(()=>[a(t.$slots,"footer")]),aside:n(()=>[a(t.$slots,"aside")]),"aside-custom":n(()=>[a(t.$slots,"aside-custom")]),default:n(()=>[a(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{$ as default,v as usePageData};
